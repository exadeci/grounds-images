FROM ruby:latest

RUN gem install rails --version 4.2

ENV FILE prog.rb
ENV EXEC ruby $FILE

ENV DEV /home/dev
ENV RUBYOPT -r $DEV/sync.rb

# We also need sync.rb file to capture output in real time
COPY . $DEV

RUN useradd dev
RUN chown -R dev: $DEV

USER dev
WORKDIR $DEV

ENTRYPOINT ["./run.sh"]
